<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Code Redeem System</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f5f5f5; }
    h2 { color: #333; }
    .box { background: white; padding: 20px; margin: 20px 0; border-radius: 10px; box-shadow: 0 0 5px #ccc; }
    input, button { padding: 10px; margin: 5px 0; width: 100%; box-sizing: border-box; }
    .success { color: green; }
    .error { color: red; }
    label { font-weight: bold; }
  </style>
</head>
<body>

  <h1>üéÅ Code Redeem System</h1>

  <div class="box">
    <h2>User: Redeem Code</h2>
    <input type="text" id="redeemCode" placeholder="Enter Code">
    <button onclick="redeem()">Redeem</button>
    <p id="redeemResult"></p>
  </div>

  <div class="box">
    <h2>Admin: Create Code</h2>
    <label>Reward:</label>
    <input type="text" id="reward" placeholder="e.g. 100 Coins">
    <label>Limit:</label>
    <input type="number" id="limit" placeholder="e.g. 5">
    <label>Expiry:</label>
    <input type="datetime-local" id="expiry">
    <button onclick="createCode()">Generate Code</button>
    <p id="adminResult"></p>
    <h3>Existing Codes:</h3>
    <ul id="codeList"></ul>
  </div>

<script>
let codes = JSON.parse(localStorage.getItem('codes')) || [];

function saveCodes() {
  localStorage.setItem('codes', JSON.stringify(codes));
  displayCodes();
}

function displayCodes() {
  const ul = document.getElementById('codeList');
  ul.innerHTML = '';
  codes.forEach(c => {
    const li = document.createElement('li');
    li.innerHTML = `${c.code} ‚Äî ${c.reward} ‚Äî Used: ${c.used}/${c.limit} ‚Äî Expires: ${new Date(c.expiry).toLocaleString()}`;
    ul.appendChild(li);
  });
}

function createCode() {
  const reward = document.getElementById('reward').value;
  const limit = parseInt(document.getElementById('limit').value);
  const expiry = new Date(document.getElementById('expiry').value).getTime();

  if (!reward || !limit || !expiry) {
    document.getElementById('adminResult').innerText = '‚ùå Fill all fields';
    return;
  }

  const code = Math.random().toString(36).substring(2, 10).toUpperCase();
  codes.push({ code, reward, limit, used: 0, expiry });
  saveCodes();
  document.getElementById('adminResult').innerText = `‚úÖ Code Generated: ${code}`;
}

function redeem() {
  const inputCode = document.getElementById('redeemCode').value.trim().toUpperCase();
  const now = Date.now();
  const code = codes.find(c => c.code === inputCode);

  const msg = document.getElementById('redeemResult');

  if (!code) {
    msg.innerHTML = '<span class="error">‚ùå Invalid Code</span>';
    return;
  }
  if (code.used >= code.limit) {
    msg.innerHTML = '<span class="error">‚ùå Code usage limit reached</span>';
    return;
  }
  if (now > code.expiry) {
    msg.innerHTML = '<span class="error">‚ùå Code expired</span>';
    return;
  }

  code.used++;
  saveCodes();
  msg.innerHTML = `<span class="success">‚úÖ Success! You got: ${code.reward}</span>`;
}

displayCodes();
</script>

</body>
</html>
